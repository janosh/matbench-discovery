model_name: eqnorm_mptrj # required (this must match the model's label which is the 3rd arg in the matbench_discovery.preds.Model enum)
model_key: eqnorm-mptrj # this should match the name of the YAML file and determines the URL /models/<model_key> on which details of the model are displayed on the website
model_version: "0.1.0"
date_added: "2025-05-26"
date_published: "2025-05-26"
authors:
  - name: Yuzhuo Chen
    affiliation: Zhejiang Lab
    email: chenyuzhuo@zhejianglab.org
    orcid: https://orcid.org/0009-0003-4044-2372
  - name: Lyuwen Fu
    affiliation: Zhejiang Lab
    email: lyuwenfu@zhejianglab.org
  - name: Shuxiang Yang
    affiliation: Zhejiang Lab
    email: yang_shuxiang@zhejianglab.org
  - name: Lipeng Chen
    affiliation: Zhejiang Lab
    email: chenlp@zhejianglab.org
    corresponding: true
trained_by:
  - name: Yuzhuo Chen
    affiliation: Zhejiang Lab
    email: chenyuzhuo@zhejianglab.org
    orcid: https://orcid.org/0009-0003-4044-2372

repo: https://github.com/yzchen08/eqnorm
url: https://github.com/yzchen08/eqnorm/tree/main/eqnorm
pr_url: https://github.com/janosh/matbench-discovery/pull/258
doi: missing # to be released soon
paper: missing # to be released soon
checkpoint_url: https://figshare.com/files/54851735

license:
  code: MIT
  code_url: https://github.com/yzchen08/eqnorm/blob/main/LICENSE
  checkpoint: MIT
  checkpoint_url: https://github.com/yzchen08/eqnorm/blob/main/LICENSE

openness: OSOD
train_task: S2EFS
test_task: IS2RE-SR
targets: EFS_G
model_type: UIP
model_params: 1310024
trained_for_benchmark: true
n_estimators: 1

hyperparams:
  max_force: 0.02
  max_steps: 500
  ase_optimizer: FIRE
  cell_filter: FrechetCellFilter
  loss: Huber
  loss_weights:
    energy: 20.0
    force: 20.0
    stress: 320.0
  optimizer: AdamW
  weight_decay: 0.001
  clip_grad_norm: 100
  ema_decay: 0.999
  max_learning_rate: 0.01
  min_learning_rate: 0.000001
  learning_rate_schedule: warmcosine
  warmup_factor: 0.2
  epochs: 100
  batch_train: 128
  n_layers: 4
  num_embedding_features: 128
  num_bessel_basis: 8
  invariant_layers: 2
  invariant_neurons: 64
  poly_p: 6
  graph_construction_radius: 6.0
  max_neighbors: .inf
  irreps_hidden: 128x0e+64x1o+32x2e+32x3o
  irreps_sh: 1x0e+1x1o+1x2e+1x3o
  energy_shift: per_species
  energy_scale: force_rms
  shift_trainable: false
  scale_trainable: false

requirements: # strongly recommended
  torch: "2.2.2"
  torch-geometric: "2.6.1"
  ase: "3.24.0"
  vesin: "0.3.2"
  e3nn: "0.5.6"
  pymatgen: "2025.3.10"
  numpy: "2.2.4"
  wget: "3.2"

training_set: [MPtrj]

training_cost:
  Nvidia A100 GPUs: { amount: 4, hours: 500 }

notes: # notes can have any key, be multiline and support markdown.
  description: |
    "eqnorm is a graph neural network model designed for predicting the energy, forces, and stresses of materials.
    The model utilizes a combination of invariant and equivariant layers to effectively capture the symmetries present in material structures."

metrics:
  phonons:
    kappa_103:
      Îº_SRME: 0.4450
      pred_file: models/eqnorm/eqnorm-mptrj/2025-05-28-kappa-103-FIRE-dist=0.03-fmax=1e-4-symprec=1e-5.json.gz
      pred_file_url: https://figshare.com/files/54876485
  geo_opt:
    pred_file: models/eqnorm/eqnorm-mptrj/2025-05-28-wbm-IS2RE-FIRE.jsonl.gz
    pred_file_url: https://figshare.com/files/54917525
    struct_col: eqnorm_structure
    symprec=1e-2:
      rmsd: 0.0839 # unitless
      n_sym_ops_mae: 1.8038 # unitless
      symmetry_decrease: 0.0579 # fraction
      symmetry_match: 0.811 # fraction
      symmetry_increase: 0.1239 # fraction
      n_structures: 256963 # count
      analysis_file: models/eqnorm/eqnorm-mptrj/2025-05-28-wbm-IS2RE-FIRE-symprec=1e-2-moyo=0.4.2.csv.gz
      analysis_file_url: https://figshare.com/files/54920462
    symprec=1e-5:
      rmsd: 0.0839 # unitless
      n_sym_ops_mae: 2.0407 # unitless
      symmetry_decrease: 0.0632 # fraction
      symmetry_match: 0.6987 # fraction
      symmetry_increase: 0.232 # fraction
      n_structures: 256963 # count
      analysis_file: models/eqnorm/eqnorm-mptrj/2025-05-28-wbm-IS2RE-FIRE-symprec=1e-5-moyo=0.4.2.csv.gz
      analysis_file_url: https://figshare.com/files/54920507
  discovery:
    pred_file: models/eqnorm/eqnorm-mptrj/2025-05-28-wbm-IS2RE.csv.gz
    pred_file_url: https://figshare.com/files/54915227
    pred_col: e_form_per_atom_eqnorm
    full_test_set:
      F1: 0.768 # fraction
      DAF: 4.247 # dimensionless
      Precision: 0.729 # fraction
      Recall: 0.812 # fraction
      Accuracy: 0.916 # fraction
      TPR: 0.812 # fraction
      FPR: 0.063 # fraction
      TNR: 0.937 # fraction
      FNR: 0.188 # fraction
      TP: 35789.0 # count
      FP: 13319.0 # count
      TN: 199552.0 # count
      FN: 8303.0 # count
      MAE: 0.039 # eV/atom
      RMSE: 0.082 # eV/atom
      R2: 0.794 # dimensionless
      missing_preds: 2 # count
      missing_percent: 0.00% # fraction
    unique_prototypes:
      F1: 0.776 # fraction
      DAF: 4.792 # dimensionless
      Precision: 0.732 # fraction
      Recall: 0.825 # fraction
      Accuracy: 0.926 # fraction
      TPR: 0.825 # fraction
      FPR: 0.055 # fraction
      TNR: 0.945 # fraction
      FNR: 0.175 # fraction
      TP: 27538.0 # count
      FP: 10057.0 # count
      TN: 172057.0 # count
      FN: 5836.0 # count
      MAE: 0.041 # eV/atom
      RMSE: 0.083 # eV/atom
      R2: 0.796 # dimensionless
      missing_preds: 0 # count
      missing_percent: 0.00% # fraction
    most_stable_10k:
      F1: 0.971 # fraction
      DAF: 6.17 # dimensionless
      Precision: 0.943 # fraction
      Recall: 1.0 # fraction
      Accuracy: 0.943 # fraction
      TPR: 1.0 # fraction
      FPR: 1.0 # fraction
      TNR: 0.0 # fraction
      FNR: 0.0 # fraction
      TP: 9432.0 # count
      FP: 568.0 # count
      TN: 0.0 # count
      FN: 0.0 # count
      MAE: 0.038 # eV/atom
      RMSE: 0.098 # eV/atom
      R2: 0.802 # dimensionless
      missing_preds: 0 # count
      missing_percent: 0.00% # fraction
