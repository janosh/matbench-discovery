# deno-fmt-ignore-file

seed: 42
device: cuda
base_precision: 32

architecture:
  name: pet
  atomic_types: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102]
  model:
    d_pet: 640
    d_node: 2560
    d_feedforward: 1280
    d_head: 640
    num_gnn_layers: 5
    num_attention_layers: 3
    cutoff: 10.0
    num_neighbors_adaptive: 40
    cutoff_width: 0.5
    cutoff_function: Bump
  training:
    fixed_composition_weights:
      energy: {1: -3.031273365020752, 2: 0.027799198403954506, 3: -2.0805065631866455, 4: -2.8476407527923584, 5: -5.574077129364014, 6: -6.980109691619873, 7: -7.590389728546143, 8: -6.851181983947754, 9: -4.530276298522949, 10: 0.3762491047382355, 11: -1.253917932510376, 12: -1.2814829349517822, 13: -3.531726360321045, 14: -5.160630702972412, 15: -5.280490875244141, 16: -5.172725200653076, 17: -2.9537248611450195, 18: 0.09453830122947693, 19: -0.5304666757583618, 20: -1.930411458015442, 21: -6.348842144012451, 22: -7.733168125152588, 23: -8.103525161743164, 24: -8.008460998535156, 25: -7.960065841674805, 26: -6.939455509185791, 27: -5.932652950286865, 28: -4.829807281494141, 29: -2.913503408432007, 30: -0.9246549010276794, 31: -2.836353063583374, 32: -4.337625503540039, 33: -4.584407806396484, 34: -4.341447353363037, 35: -2.4020133018493652, 36: 0.23834826052188873, 37: -0.9047374725341797, 38: -1.9698176383972168, 39: -6.506529331207275, 40: -8.434303283691406, 41: -9.02372932434082, 42: -9.166694641113281, 43: -8.957742691040039, 44: -8.005958557128906, 45: -6.876678466796875, 46: -5.215369701385498, 47: -2.0827369689941406, 48: -0.3006742298603058, 49: -2.2366256713867188, 50: -3.7363791465759277, 51: -3.913025140762329, 52: -3.5597147941589355, 53: -1.9088412523269653, 54: 3.221863031387329, 55: -0.9579359889030457, 56: -2.018587112426758, 57: -5.003512382507324, 58: -6.514340400695801, 59: -4.891188144683838, 60: -4.857710838317871, 61: -4.921123504638672, 62: -4.788905620574951, 63: -10.40697956085205, 64: -13.872601509094238, 65: -4.780577182769775, 66: -4.514822483062744, 67: -4.483928680419922, 68: -4.474108695983887, 69: -4.49116849899292, 70: -4.90941858291626, 71: -4.465046405792236, 72: -9.28829288482666, 73: -10.675433158874512, 74: -10.503630638122559, 75: -10.137602806091309, 76: -9.185210227966309, 77: -7.9145731925964355, 78: -6.0684638023376465, 79: -3.0563039779663086, 80: 0.17831231653690338, 81: -1.9524003267288208, 82: -3.1373376846313477, 83: -3.589962959289551, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: -4.476114749908447, 90: -7.909163475036621, 91: -10.146844863891602, 92: -12.388452529907227, 93: -13.565378189086914, 94: -14.341865539550781, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0}
    fixed_scaling_weights:
      energy: 0.18707635
      non_conservative_forces: {1: 1.1348935440490968, 2: 0.31726057689407194, 3: 0.30729814449891163, 4: 0.5474959194735763, 5: 1.2238835217330835, 6: 1.18814019979746, 7: 1.284716436952899, 8: 1.499465452133921, 9: 0.8181982679223648, 10: 0.19581522539979468, 11: 0.35227005457268595, 12: 0.46337881444631607, 13: 0.5825069641068137, 14: 0.8480365673291788, 15: 1.1264452021296023, 16: 0.6411636100127582, 17: 0.4562694254351398, 18: 0.6421097574865451, 19: 0.34390617615531854, 20: 0.4531246551996245, 21: 0.45917474534629726, 22: 0.8581696511199095, 23: 0.9027023202283941, 24: 0.8414987662026218, 25: 0.8599788626519479, 26: 0.9495272646956523, 27: 0.859492100498258, 28: 0.8768606475008769, 29: 0.7361332396148073, 30: 0.5249131494984118, 31: 0.6184228614610641, 32: 0.6798544921334894, 33: 0.604096281515038, 34: 0.5260172536068966, 35: 0.39871804101258135, 36: 0.9149606365044084, 37: 0.2942497487870866, 38: 0.33679112402610745, 39: 0.37446517130665624, 40: 0.523246821486943, 41: 1.0333996434506354, 42: 0.9418447841669491, 43: 0.8579411723915696, 44: 0.9029812502785103, 45: 0.8365902907081489, 46: 0.5755700812486781, 47: 0.5237000907485965, 48: 0.5195318311538443, 49: 0.49499855455192343, 50: 0.5262814302902591, 51: 0.5244078213849649, 52: 0.46626395015796657, 53: 0.3956473272939508, 54: 2.6839717808990127, 55: 0.3267377911471432, 56: 0.4850782234402257, 57: 0.4666200577060135, 58: 0.7341755008707604, 59: 0.4075424213784059, 60: 0.42167824322182623, 61: 0.4124784710086991, 62: 0.3868581044615812, 63: 0.5298118874071753, 64: 0.713160430038959, 65: 0.3795499836945927, 66: 0.5062615602593908, 67: 0.5096129568246182, 68: 0.49322471796657613, 69: 0.4120678628017545, 70: 0.8579980484263544, 71: 0.6511306820325556, 72: 0.7262737278282132, 73: 0.8617541594827806, 74: 1.035728249312085, 75: 1.1704171021879928, 76: 1.131496602598173, 77: 0.8652421807386526, 78: 0.75116165828923, 79: 0.5961349840918925, 80: 0.5192361817805127, 81: 0.40274513736377526, 82: 0.4827509123835973, 83: 0.43938925443467997, 84: 1.0, 85: 1.0, 86: 1.0, 87: 1.0, 88: 1.0, 89: 0.6108483362501008, 90: 0.5334051746362279, 91: 0.9607080793297238, 92: 1.0701548887152343, 93: 1.0423109640821573, 94: 0.8422086797561263, 95: 1.0, 96: 1.0, 97: 1.0, 98: 1.0, 99: 1.0, 100: 1.0, 101: 1.0, 102: 1.0}
      non_conservative_stress: 0.01458056075
    distributed: True
    num_epochs: 10
    warmup_fraction: 0.1
    learning_rate: 2e-4
    checkpoint_interval: 1
    batch_size: 4
    per_structure_targets: ["non_conservative_stress"]
    loss:
      energy:
        weight: 0.01
        type: huber
        delta: 0.015
      non_conservative_forces:
        weight: 1.0
        type: huber
        delta: 0.010
      non_conservative_stress:
        weight: 0.01
        type: huber
        delta: 0.005

training_set:
  systems:
    read_from: /tmp/omat_train_mm/
    length_unit: angstrom
  targets:
    energy:
      key: e
      unit: eV
      forces: off
      stress: off
      virial: off
    non_conservative_forces:
      key: f
      quantity: force
      unit: eV/A
      per_atom: true
      type:
        cartesian:
          rank: 1
    non_conservative_stress:
      key: s
      quantity: pressure
      unit: eV/A^3
      type:
        cartesian:
          rank: 2

validation_set:
  systems:
    read_from: /tmp/omat_val_mm/
    length_unit: angstrom
  targets:
    energy:
      key: e
      unit: eV
      forces: off
      stress: off
      virial: off
    non_conservative_forces:
      key: f
      quantity: force
      unit: eV/A
      per_atom: true
      type:
        cartesian:
          rank: 1
    non_conservative_stress:
      key: s
      quantity: pressure
      unit: eV/A^3
      type:
        cartesian:
          rank: 2

test_set: 0.0
