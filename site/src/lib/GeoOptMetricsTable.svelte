<script lang="ts">
  import { HeatmapTable } from '$lib'
  import type { ModelData } from '$lib/types'
  import { GEO_OPT_SYMMETRY_METRICS, METADATA_COLS, METRICS } from './labels'
  import { assemble_row_data } from './metrics'

  let { ...rest } = $props()

  let columns = $derived([
    METADATA_COLS.model_name,
    METRICS.RMSD,
    ...Object.values(GEO_OPT_SYMMETRY_METRICS).map((col) => ({ ...col, visible: true })),
  ])

  const discovery_set = `full_test_set`
  const model_filter = (_model: ModelData) => true
  const show_energy_only = false
  const show_noncompliant = true
  // recalculate metrics_data whenever filter settings change
  let metrics_data = $derived(
    assemble_row_data(discovery_set, model_filter, show_energy_only, show_noncompliant),
  )
</script>

<HeatmapTable data={metrics_data} {columns} {...rest} />
